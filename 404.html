<!DOCTYPE html>
<html lang="bn">
<head>
  <base href="./">
    
 <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#3498db">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ ‡¶∏‡¶π‡¶æ‡¶Ø‡¶º‡¶ø‡¶ï‡¶æ">
    <meta name="description" content="‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ ‡¶∏‡¶π‡¶æ‡¶Ø‡¶º‡¶ø‡¶ï‡¶æ - ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ ‡ß¨-‡ßß‡ß¶ ‡¶™‡¶∞‡ßç‡¶Ø‡¶®‡ßç‡¶§ ‡¶∏‡¶ï‡¶≤ ‡¶¨‡¶á, ‡¶ó‡¶æ‡¶á‡¶°, ‡¶®‡ßã‡¶ü, ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶è‡¶¨‡¶Ç ‡¶´‡¶æ‡¶á‡¶≤">
    <meta name="keywords" content="‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ, ‡¶¨‡¶á, ‡¶ó‡¶æ‡¶á‡¶°, ‡¶®‡ßã‡¶ü, ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì, PDF, ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂, ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ ‡ß¨-‡ßß‡ß¶">
    <title>‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ ‡¶∏‡¶π‡¶æ‡¶Ø‡¶º‡¶ø‡¶ï‡¶æ</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="https://i.ibb.co/XGNQ8V4/icon-180x180.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://i.ibb.co/XGNQ8V4/icon-180x180.png">
    <link rel="apple-touch-icon" sizes="167x167" href="https://i.ibb.co/XGNQ8V4/icon-180x180.png">
    <link rel="apple-touch-icon" sizes="152x152" href="https://i.ibb.co/XGNQ8V4/icon-180x180.png">
    <link rel="apple-touch-icon" sizes="120x120" href="https://i.ibb.co/XGNQ8V4/icon-180x180.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="https://i.ibb.co/wFnz89n6/icon-192x192.png">
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-storage-compat.js"></script>
    
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2c3e50;
            --success-color: #27ae60;
            --danger-color: #e74c3c;
            --warning-color: #f39c12;
            --dark-color: #2c3e50;
            --light-color: #ecf0f1;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, var(--secondary-color), #4a6491);
            color: #333;
            min-height: 100vh;
            -webkit-tap-highlight-color: transparent;
        }
        
        /* App Container */
        .app-container {
            max-width: 1200px;
            margin: 20px auto;
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Header */
        .app-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 25px 30px;
            text-align: center;
            position: relative;
        }
        
        .header-content h1 {
            font-size: 28px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .header-content h1 img {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            border: 3px solid white;
        }
        
        .header-content .subtitle {
            font-size: 16px;
            opacity: 0.9;
            margin-top: 5px;
        }
        
        /* Auth Container */
        .auth-container {
            padding: 40px 30px;
            display: block;
        }
        
        .content-container {
            padding: 30px;
            display: none;
        }
        
        /* Auth Form */
        .auth-form {
            max-width: 450px;
            margin: 0 auto;
        }
        
        .auth-tabs {
            display: flex;
            margin-bottom: 30px;
            border-bottom: 2px solid #e0e0e0;
        }
        
        .auth-tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            font-weight: bold;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }
        
        .auth-tab.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }
        
        .auth-form-section {
            display: none;
        }
        
        .auth-form-section.active {
            display: block;
        }
        
        /* Form Elements */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: var(--secondary-color);
            font-size: 14px;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 14px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            border-color: var(--primary-color);
            outline: none;
        }
        
        /* Buttons */
        .btn {
            background: linear-gradient(135deg, var(--primary-color), #2980b9);
            color: white;
            border: none;
            padding: 16px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            width: 100%;
            transition: all 0.3s;
            margin-top: 10px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
        }
        
        .btn-success {
            background: linear-gradient(135deg, var(--success-color), #219653);
        }
        
        .logout-btn {
            background: var(--danger-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s;
        }
        
        .logout-btn:hover {
            background: #c0392b;
        }
        
        /* User Info */
        .user-info {
            background: var(--light-color);
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 2px solid var(--primary-color);
        }
        
        .user-details {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .user-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
        }
        
        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 2px solid #e0e0e0;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        .tab {
            padding: 15px 20px;
            cursor: pointer;
            background: none;
            border: none;
            font-size: 16px;
            font-weight: bold;
            color: #7f8c8d;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }
        
        .tab.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Class Grid */
        .class-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .class-card {
            background: white;
            border-radius: 15px;
            padding: 25px 15px;
            text-align: center;
            box-shadow: 0 6px 12px rgba(0,0,0,0.08);
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.3s;
            border: 2px solid #e0e0e0;
        }
        
        .class-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary-color);
            box-shadow: 0 10px 20px rgba(52, 152, 219, 0.2);
        }
        
        .class-card .class-icon {
            font-size: 48px;
            margin-bottom: 15px;
            display: block;
        }
        
        .class-card h3 {
            color: var(--secondary-color);
            margin-bottom: 8px;
            font-size: 20px;
        }
        
        .class-card p {
            color: #666;
            font-size: 14px;
        }
        
        /* Material Items */
        .material-item {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 5px solid var(--primary-color);
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
            border: 1px solid #e9ecef;
            transition: all 0.3s;
        }
        
        .material-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(52, 152, 219, 0.1);
        }
        
        .material-item h4 {
            color: var(--secondary-color);
            margin-bottom: 10px;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .material-type {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-right: 10px;
        }
        
        .material-type.book { background: #e3f2fd; color: #1976d2; }
        .material-type.guide { background: #e8f5e9; color: #388e3c; }
        .material-type.note { background: #fff3e0; color: #f57c00; }
        .material-type.video { background: #f3e5f5; color: #7b1fa2; }
        .material-type.image { background: #e0f7fa; color: #0097a7; }
        .material-type.pdf { background: #ffebee; color: #d32f2f; }
        .material-type.question { background: #fce4ec; color: #c2185b; }
        
        .material-meta {
            display: flex;
            gap: 15px;
            margin-top: 15px;
            font-size: 14px;
            color: #666;
        }
        
        .material-meta span {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        /* File Actions */
        .file-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .view-btn, .download-btn, .open-btn {
            padding: 8px 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        
        .view-btn { background: var(--success-color); color: white; }
        .download-btn { background: var(--primary-color); color: white; }
        .open-btn { background: var(--warning-color); color: white; }
        
        .view-btn:hover { background: #219653; }
        .download-btn:hover { background: #2980b9; }
        .open-btn:hover { background: #d68910; }
        
        /* File Type Badges */
        .file-type-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: bold;
            margin-right: 5px;
        }
        
        .file-type-pdf { background: #ffebee; color: #d32f2f; }
        .file-type-image { background: #e8f5e9; color: #388e3c; }
        .file-type-video { background: #f3e5f5; color: #7b1fa2; }
        .file-type-doc { background: #e3f2fd; color: #1976d2; }
        .file-type-zip { background: #fff3e0; color: #f57c00; }
        .file-type-other { background: #f5f5f5; color: #616161; }
        
        /* Search */
        .search-container {
            margin-bottom: 25px;
            position: relative;
        }
        
        .search-input {
            width: 100%;
            padding: 14px 50px 14px 20px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .search-input:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary-color);
            font-size: 20px;
        }
        
        /* Loading */
        .loading {
            text-align: center;
            padding: 40px;
            color: var(--primary-color);
        }
        
        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--primary-color);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #666;
        }
        
        /* Back Button */
        .back-btn {
            background: #95a5a6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin-bottom: 20px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .back-btn:hover {
            background: #7f8c8d;
            transform: translateX(-3px);
        }
        
        /* Subject Cards */
        .subject-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .subject-card {
            background: white;
            border-radius: 15px;
            padding: 25px 15px;
            text-align: center;
            box-shadow: 0 6px 12px rgba(0,0,0,0.08);
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.3s;
            border: 2px solid #e0e0e0;
        }
        
        .subject-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary-color);
            box-shadow: 0 10px 20px rgba(52, 152, 219, 0.2);
        }
        
        .subject-card .subject-icon {
            font-size: 40px;
            margin-bottom: 15px;
            display: block;
        }
        
        .subject-card h3 {
            color: var(--secondary-color);
            margin-bottom: 8px;
            font-size: 18px;
        }
        
        .subject-card p {
            color: #666;
            font-size: 14px;
        }
        
        /* File Preview */
        .file-preview {
            max-width: 200px;
            max-height: 200px;
            margin: 10px 0;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        /* PWA Install Button */
        .install-btn {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin: 10px 0;
            transition: all 0.3s;
        }
        
        .install-btn:hover {
            background: linear-gradient(135deg, #8e44ad, #7d3c98);
            transform: translateY(-2px);
        }
        
        /* Status Messages */
        .status-message {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 10px;
            color: white;
            z-index: 9996;
            display: none;
            animation: slideDown 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        @keyframes slideDown {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .status-success {
            background: var(--success-color);
        }
        
        .status-error {
            background: var(--danger-color);
        }
        
        .status-warning {
            background: var(--warning-color);
        }
        
        .status-info {
            background: var(--primary-color);
        }
        
        /* File Section */
        .file-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            border: 1px solid #e9ecef;
        }
        
        /* Two Column Layout */
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
        }
        
        @media (max-width: 768px) {
            .two-column {
                grid-template-columns: 1fr;
            }
            
            .class-grid, .subject-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .app-container {
                margin: 10px;
                border-radius: 15px;
            }
        }
        
        @media (max-width: 480px) {
            .class-grid, .subject-grid {
                grid-template-columns: 1fr;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                padding: 12px;
            }
        }
        
        /* Touch Optimizations */
        @media (hover: none) and (pointer: coarse) {
            .btn, .view-btn, .download-btn, .open-btn, .logout-btn {
                min-height: 44px;
                min-width: 44px;
            }
            
            input, select, textarea, button {
                font-size: 16px !important;
            }
        }
        
        /* PWA Status */
        .pwa-status {
            position: fixed;
            top: 15px;
            right: 15px;
            background: var(--success-color);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            z-index: 9997;
            display: none;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(39, 174, 96, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(39, 174, 96, 0); }
            100% { box-shadow: 0 0 0 0 rgba(39, 174, 96, 0); }
        }
    </style>
</head>
<body>
    <!-- PWA Status -->
    <div class="pwa-status" id="pwaStatus">üì± ‡¶á‡¶®‡¶∏‡ßç‡¶ü‡¶≤ ‡¶ï‡¶∞‡¶æ</div>
    
    <!-- Status Message -->
    <div id="statusMessage" class="status-message"></div>
    
    <!-- App Container -->
    <div class="app-container">
        <!-- Header -->
        <div class="app-header">
            <div class="header-content">
                <h1>
                    <img src="https://i.ibb.co/wFnz89n6/icon-192x192.png" alt="‡¶Ü‡¶á‡¶ï‡¶®">
                    ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ ‡¶∏‡¶π‡¶æ‡¶Ø‡¶º‡¶ø‡¶ï‡¶æ
                </h1>
                <div class="subtitle">‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ ‡ß¨-‡ßß‡ß¶ ‡¶™‡¶∞‡ßç‡¶Ø‡¶®‡ßç‡¶§ ‡¶∏‡¶ï‡¶≤ ‡¶¨‡¶á, ‡¶ó‡¶æ‡¶á‡¶°, ‡¶®‡ßã‡¶ü, ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶è‡¶¨‡¶Ç ‡¶´‡¶æ‡¶á‡¶≤</div>
            </div>
        </div>
        
        <!-- Auth Section -->
        <div id="authSection" class="auth-container">
            <div class="auth-form">
                <h2 style="text-align: center; margin-bottom: 30px; color: var(--secondary-color);">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü</h2>
                
                <!-- Message Display -->
                <div id="authMessage" style="display: none; padding: 15px; border-radius: 10px; margin-bottom: 20px; text-align: center;"></div>
                
                <!-- Tabs -->
                <div class="auth-tabs">
                    <div id="loginTab" class="auth-tab active" onclick="showAuthForm('login')">‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</div>
                    <div id="registerTab" class="auth-tab" onclick="showAuthForm('register')">‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®</div>
                </div>
                
                <!-- Login Form -->
                <div id="loginForm" class="auth-form-section active">
                    <div class="form-group">
                        <label>‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶Ö‡¶•‡¶¨‡¶æ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ:</label>
                        <input type="text" id="loginEmailUsername" placeholder="‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶¨‡¶æ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ ‡¶¶‡¶ø‡¶®" autocomplete="username">
                    </div>
                    
                    <div class="form-group">
                        <label>‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°:</label>
                        <input type="password" id="loginPassword" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶¶‡¶ø‡¶®" autocomplete="current-password">
                    </div>
                    
                    <button onclick="loginUser()" class="btn" id="loginBtn">‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                    
                    <div style="text-align: center; margin-top: 15px;">
                        <a onclick="showForgotPassword()" style="color: var(--primary-color); cursor: pointer; text-decoration: underline;">
                            ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶≠‡ßÅ‡¶≤‡ßá ‡¶ó‡ßá‡¶õ‡ßá‡¶®?
                        </a>
                    </div>
                </div>
                
                <!-- Register Form -->
                <div id="registerForm" class="auth-form-section">
                    <div class="form-group">
                        <label>‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ:</label>
                        <input type="text" id="registerUsername" placeholder="‡¶®‡¶§‡ßÅ‡¶® ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ" autocomplete="username">
                    </div>
                    
                    <div class="form-group">
                        <label>‡¶á‡¶Æ‡ßá‡¶á‡¶≤:</label>
                        <input type="email" id="registerEmail" placeholder="‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ" autocomplete="email">
                    </div>
                    
                    <div class="form-group">
                        <label>‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°:</label>
                        <input type="password" id="registerPassword" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° (‡ß¨+ ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞)" autocomplete="new-password">
                    </div>
                    
                    <div class="form-group">
                        <label>‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®:</label>
                        <input type="password" id="registerConfirmPassword" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶¶‡¶ø‡¶®" autocomplete="new-password">
                    </div>
                    
                    <button onclick="registerUser()" class="btn btn-success" id="registerBtn">‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                </div>
                
                <!-- Forgot Password Modal -->
                <div id="forgotPasswordModal" style="display: none; margin-top: 20px; padding: 20px; background: #f8f9fa; border-radius: 10px; border: 2px solid var(--primary-color);">
                    <h4 style="color: var(--secondary-color); margin-bottom: 15px;">‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</h4>
                    <div class="form-group">
                        <label>‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ ‡¶Ö‡¶•‡¶¨‡¶æ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤:</label>
                        <input type="text" id="forgotEmailUsername" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ ‡¶¨‡¶æ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤">
                    </div>
                    <button onclick="resetPassword()" class="btn">‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶™‡¶æ‡¶†‡¶æ‡¶®</button>
                    <button onclick="hideForgotPassword()" class="btn" style="background: #95a5a6; margin-top: 10px;">‡¶¨‡¶æ‡¶§‡¶ø‡¶≤ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                </div>
            </div>
        </div>
        
        <!-- Content Section -->
        <div id="contentSection" class="content-container">
            <!-- User Info -->
            <div class="user-info">
                <div class="user-details">
                    <div class="user-avatar" id="userAvatar">U</div>
                    <div>
                        <div id="userNameDisplay" style="font-weight: bold; color: var(--secondary-color);"></div>
                        <div id="userEmailDisplay" style="font-size: 14px; color: #666;"></div>
                    </div>
                </div>
                <button onclick="logoutUser()" class="logout-btn">üö™ ‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü</button>
            </div>
            
            <!-- Tabs -->
            <div class="tabs">
                <button class="tab active" onclick="switchTab('contentTab')">üìö ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü</button>
                <button class="tab" onclick="switchTab('fileTab')">üìÅ ‡¶´‡¶æ‡¶á‡¶≤</button>
                <button class="tab" onclick="switchTab('bookTab')">üìñ ‡¶¨‡¶á ‡¶ì ‡¶ó‡¶æ‡¶á‡¶°</button>
                <button class="tab" onclick="switchTab('videoTab')">üé¨ ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì</button>
            </div>
            
            <!-- Content Tab -->
            <div id="contentTab" class="tab-content active">
                <div class="search-container">
                    <input type="text" id="searchContent" class="search-input" placeholder="üîç ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®...">
                    <div class="search-icon">üîç</div>
                </div>
                
                <!-- Class Selection -->
                <div id="classSection">
                    <h2 style="text-align: center; margin-bottom: 20px; color: var(--secondary-color);">üëâ ‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</h2>
                    <div id="classGrid" class="class-grid">
                        <!-- Classes will be loaded here -->
                    </div>
                </div>
                
                <!-- Subject Selection -->
                <div id="subjectSection" style="display: none;">
                    <button onclick="goBackToClasses()" class="back-btn">‚Üê ‡¶´‡¶ø‡¶∞‡ßá ‡¶Ø‡¶æ‡¶®</button>
                    <h2 id="classNameDisplay" style="margin-bottom: 20px; color: var(--secondary-color);"></h2>
                    <div id="subjectGrid" class="subject-grid">
                        <!-- Subjects will be loaded here -->
                    </div>
                </div>
                
                <!-- Materials Display -->
                <div id="materialsSection" style="display: none;">
                    <button onclick="goBackToSubjects()" class="back-btn">‚Üê ‡¶´‡¶ø‡¶∞‡ßá ‡¶Ø‡¶æ‡¶®</button>
                    <h2 id="subjectNameDisplay" style="margin-bottom: 20px; color: var(--secondary-color);"></h2>
                    <div id="materialsList">
                        <!-- Materials will be loaded here -->
                    </div>
                </div>
            </div>
            
            <!-- File Tab -->
            <div id="fileTab" class="tab-content">
                <div class="file-section">
                    <h3 style="margin-bottom: 20px; color: var(--secondary-color);">üìÅ ‡¶´‡¶æ‡¶á‡¶≤ ‡¶∏‡¶Ç‡¶ó‡ßç‡¶∞‡¶π</h3>
                    
                    <div class="search-container">
                        <input type="text" id="searchFiles" class="search-input" placeholder="üîç ‡¶´‡¶æ‡¶á‡¶≤ ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®...">
                        <div class="search-icon">üîç</div>
                    </div>
                    
                    <div id="filesLoading" class="loading">
                        <div class="loading-spinner"></div>
                        <p>‡¶´‡¶æ‡¶á‡¶≤ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>
                    </div>
                    
                    <div id="filesList">
                        <!-- Files will be loaded here -->
                    </div>
                </div>
            </div>
            
            <!-- Book Tab -->
            <div id="bookTab" class="tab-content">
                <div class="file-section">
                    <h3 style="margin-bottom: 20px; color: var(--secondary-color);">üìñ ‡¶¨‡¶á ‡¶ì ‡¶ó‡¶æ‡¶á‡¶°</h3>
                    <div id="booksList">
                        <!-- Books will be loaded here -->
                    </div>
                </div>
            </div>
            
            <!-- Video Tab -->
            <div id="videoTab" class="tab-content">
                <div class="file-section">
                    <h3 style="margin-bottom: 20px; color: var(--secondary-color);">üé¨ ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ‡¶Æ‡ßÇ‡¶≤‡¶ï ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì</h3>
                    <div id="videosList">
                        <!-- Videos will be loaded here -->
                    </div>
                </div>
            </div>
            
            <!-- PWA Install Button -->
            <div style="text-align: center; margin-top: 30px; padding: 20px; background: linear-gradient(135deg, #f5f7fa, #c3cfe2); border-radius: 15px; border: 2px dashed var(--primary-color);">
                <h3 style="color: var(--secondary-color); margin-bottom: 15px;">üì± ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶á‡¶®‡¶∏‡ßç‡¶ü‡¶≤ ‡¶ï‡¶∞‡ßÅ‡¶®</h3>
                <p style="color: #666; margin-bottom: 15px;">‡¶π‡ßã‡¶Æ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶®‡ßá ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶ï‡¶∞‡ßá ‡¶´‡ßÅ‡¶≤-‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶® ‡¶Æ‡ßã‡¶°‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®</p>
                <button id="installButton" class="install-btn">
                    üì≤ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶á‡¶®‡¶∏‡ßç‡¶ü‡¶≤ ‡¶ï‡¶∞‡ßÅ‡¶®
                </button>
            </div>
        </div>
    </div>

    <script>
        // =================== APP CONFIGURATION ===================
        const APP_VERSION = '4.0.0';
        const APP_NAME = '‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ ‡¶∏‡¶π‡¶æ‡¶Ø‡¶º‡¶ø‡¶ï‡¶æ';
        
        // =================== FIREBASE CONFIGURATION ===================
        const firebaseConfig = {
            apiKey: "AIzaSyB1vOW-DY6zIkXhPK5CRF3N8w-LzUKsvgg",
            authDomain: "education-app-8931d.firebaseapp.com",
            databaseURL: "https://education-app-8931d-default-rtdb.firebaseio.com",
            projectId: "education-app-8931d",
            storageBucket: "education-app-8931d.firebasestorage.app",
            messagingSenderId: "667995018685",
            appId: "1:667995018685:web:c8cdc1d432748cdc98eed4"
        };
        
        // =================== GLOBAL VARIABLES ===================
        let db;
        let auth;
        let storage;
        let currentUser = null;
        let currentClass = null;
        let currentSubject = null;
        let deferredPrompt = null;
        let isAppInstalled = false;
        
        // =================== INITIALIZE FIREBASE ===================
        function initializeFirebase() {
            try {
                firebase.initializeApp(firebaseConfig);
                db = firebase.database();
                auth = firebase.auth();
                storage = firebase.storage();
                console.log("‚úÖ Firebase initialized successfully");
                setupAuth();
                setupServiceWorker();
            } catch (error) {
                console.error("‚ùå Firebase initialization error:", error);
                showStatus("Firebase ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ó ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•", "error");
            }
        }
        
        // =================== AUTHENTICATION ===================
        function setupAuth() {
            auth.onAuthStateChanged((user) => {
                if (user) {
                    currentUser = user;
                    showUserInfo(user);
                    document.getElementById('authSection').style.display = 'none';
                    document.getElementById('contentSection').style.display = 'block';
                    document.title = APP_NAME + " - " + user.email;
                    
                    loadClasses();
                    loadFiles();
                    loadBooks();
                    loadVideos();
                    
                    showStatus("‡¶≤‡¶ó‡¶á‡¶® ‡¶∏‡¶´‡¶≤", "success");
                } else {
                    currentUser = null;
                    document.getElementById('authSection').style.display = 'block';
                    document.getElementById('contentSection').style.display = 'none';
                }
            });
        }
        
        function showUserInfo(user) {
            const avatar = document.getElementById('userAvatar');
            const nameDisplay = document.getElementById('userNameDisplay');
            const emailDisplay = document.getElementById('userEmailDisplay');
            
            emailDisplay.textContent = user.email;
            
            // Get username from database
            if (db) {
                db.ref('users/' + user.uid).once('value').then(snapshot => {
                    const userData = snapshot.val();
                    if (userData && userData.username) {
                        nameDisplay.textContent = userData.username;
                        avatar.textContent = userData.username.charAt(0).toUpperCase();
                    } else {
                        nameDisplay.textContent = user.email.split('@')[0];
                        avatar.textContent = user.email.charAt(0).toUpperCase();
                    }
                });
            } else {
                nameDisplay.textContent = user.email.split('@')[0];
                avatar.textContent = user.email.charAt(0).toUpperCase();
            }
        }
        
        function loginUser() {
            const emailUsername = document.getElementById('loginEmailUsername').value.trim();
            const password = document.getElementById('loginPassword').value.trim();
            const loginBtn = document.getElementById('loginBtn');
            
            if (!emailUsername || !password) {
                showAuthMessage("‡¶á‡¶Æ‡ßá‡¶á‡¶≤/‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ ‡¶è‡¶¨‡¶Ç ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶¶‡¶ø‡¶®", "error");
                return;
            }
            
            loginBtn.disabled = true;
            loginBtn.innerHTML = "‡¶≤‡¶ó‡¶á‡¶® ‡¶π‡¶ö‡ßç‡¶õ‡ßá...";
            
            // Check if input is email or username
            const isEmail = emailUsername.includes('@');
            
            if (isEmail) {
                // Login with email
                auth.signInWithEmailAndPassword(emailUsername, password)
                    .then((userCredential) => {
                        loginBtn.disabled = false;
                        loginBtn.innerHTML = "‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®";
                    })
                    .catch((error) => {
                        loginBtn.disabled = false;
                        loginBtn.innerHTML = "‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®";
                        handleAuthError(error);
                    });
            } else {
                // Find user by username
                db.ref('users').orderByChild('username').equalTo(emailUsername).once('value')
                    .then((snapshot) => {
                        if (snapshot.exists()) {
                            let userEmail = null;
                            snapshot.forEach((child) => {
                                userEmail = child.val().email;
                            });
                            
                            if (userEmail) {
                                return auth.signInWithEmailAndPassword(userEmail, password);
                            } else {
                                throw new Error('‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø');
                            }
                        } else {
                            throw new Error('‡¶è‡¶á ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶®‡ßá‡¶á');
                        }
                    })
                    .then((userCredential) => {
                        loginBtn.disabled = false;
                        loginBtn.innerHTML = "‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®";
                    })
                    .catch((error) => {
                        loginBtn.disabled = false;
                        loginBtn.innerHTML = "‡¶≤‡¶ó‡¶á‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®";
                        showAuthMessage(error.message, "error");
                    });
            }
        }
        
        function registerUser() {
            const username = document.getElementById('registerUsername').value.trim();
            const email = document.getElementById('registerEmail').value.trim();
            const password = document.getElementById('registerPassword').value.trim();
            const confirmPassword = document.getElementById('registerConfirmPassword').value.trim();
            const registerBtn = document.getElementById('registerBtn');
            
            if (!username || !email || !password || !confirmPassword) {
                showAuthMessage("‡¶∏‡¶¨ ‡¶´‡¶ø‡¶≤‡ßç‡¶° ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®", "error");
                return;
            }
            
            if (password.length < 6) {
                showAuthMessage("‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶ï‡¶Æ‡¶™‡¶ï‡ßç‡¶∑‡ßá ‡ß¨ ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞ ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá", "error");
                return;
            }
            
            if (password !== confirmPassword) {
                showAuthMessage("‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶Æ‡¶ø‡¶≤‡¶õ‡ßá ‡¶®‡¶æ", "error");
                return;
            }
            
            if (username.length < 3) {
                showAuthMessage("‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ ‡¶ï‡¶Æ‡¶™‡¶ï‡ßç‡¶∑‡ßá ‡ß© ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞ ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá", "error");
                return;
            }
            
            registerBtn.disabled = true;
            registerBtn.innerHTML = "‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...";
            
            // Check if username already exists
            db.ref('users').orderByChild('username').equalTo(username).once('value')
                .then((snapshot) => {
                    if (snapshot.exists()) {
                        throw new Error('‡¶è‡¶á ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ ‡¶á‡¶§‡¶ø‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá');
                    }
                    
                    // Create user with email/password
                    return auth.createUserWithEmailAndPassword(email, password);
                })
                .then((userCredential) => {
                    // Save user data
                    return db.ref('users/' + userCredential.user.uid).set({
                        username: username,
                        email: email,
                        createdAt: firebase.database.ServerValue.TIMESTAMP,
                        role: 'user',
                        appVersion: APP_VERSION
                    });
                })
                .then(() => {
                    showAuthMessage("‚úÖ ‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶® ‡¶∏‡¶´‡¶≤! ‡¶∏‡ßç‡¶¨‡¶Ø‡¶º‡¶Ç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º ‡¶≤‡¶ó‡¶á‡¶® ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá", "success");
                    registerBtn.disabled = false;
                    registerBtn.innerHTML = "‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®";
                    
                    // Clear form
                    document.getElementById('registerUsername').value = '';
                    document.getElementById('registerEmail').value = '';
                    document.getElementById('registerPassword').value = '';
                    document.getElementById('registerConfirmPassword').value = '';
                })
                .catch((error) => {
                    registerBtn.disabled = false;
                    registerBtn.innerHTML = "‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®";
                    handleAuthError(error);
                });
        }
        
        function handleAuthError(error) {
            let message = "‡¶≤‡¶ó‡¶á‡¶® ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•";
            switch(error.code) {
                case 'auth/invalid-email': message = "‡¶≠‡ßÅ‡¶≤ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü"; break;
                case 'auth/user-disabled': message = "‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶®‡¶ø‡¶∑‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º"; break;
                case 'auth/user-not-found': message = "‡¶è‡¶á ‡¶á‡¶Æ‡ßá‡¶á‡¶≤‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶®‡ßá‡¶á"; break;
                case 'auth/wrong-password': message = "‡¶≠‡ßÅ‡¶≤ ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°"; break;
                case 'auth/email-already-in-use': message = "‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶á‡¶§‡¶ø‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá"; break;
                case 'auth/weak-password': message = "‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶ñ‡ßÅ‡¶¨ ‡¶¶‡ßÅ‡¶∞‡ßç‡¶¨‡¶≤"; break;
                case 'auth/too-many-requests': message = "‡¶Ö‡¶®‡ßá‡¶ï‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßá‡¶õ‡ßá‡¶®, ‡¶™‡¶∞‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®"; break;
                default: message = error.message;
            }
            showAuthMessage(message, "error");
        }
        
        function logoutUser() {
            if (confirm("‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶®?")) {
                auth.signOut()
                    .then(() => {
                        showStatus("‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü ‡¶∏‡¶´‡¶≤", "info");
                    })
                    .catch((error) => {
                        console.error("Logout error:", error);
                    });
            }
        }
        
        function showForgotPassword() {
            document.getElementById('forgotPasswordModal').style.display = 'block';
        }
        
        function hideForgotPassword() {
            document.getElementById('forgotPasswordModal').style.display = 'none';
            document.getElementById('forgotEmailUsername').value = '';
        }
        
        function resetPassword() {
            const emailUsername = document.getElementById('forgotEmailUsername').value.trim();
            
            if (!emailUsername) {
                showAuthMessage("‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ ‡¶Ö‡¶•‡¶¨‡¶æ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶¶‡¶ø‡¶®", "error");
                return;
            }
            
            const isEmail = emailUsername.includes('@');
            
            if (isEmail) {
                // Reset password with email
                auth.sendPasswordResetEmail(emailUsername)
                    .then(() => {
                        showAuthMessage("‚úÖ ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤‡ßá ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá", "success");
                        hideForgotPassword();
                    })
                    .catch((error) => {
                        handleAuthError(error);
                    });
            } else {
                // Find user by username and reset password
                db.ref('users').orderByChild('username').equalTo(emailUsername).once('value')
                    .then((snapshot) => {
                        if (snapshot.exists()) {
                            let userEmail = null;
                            snapshot.forEach((child) => {
                                userEmail = child.val().email;
                            });
                            
                            if (userEmail) {
                                return auth.sendPasswordResetEmail(userEmail);
                            } else {
                                throw new Error('‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø');
                            }
                        } else {
                            throw new Error('‡¶è‡¶á ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶®‡ßá‡¶á');
                        }
                    })
                    .then(() => {
                        showAuthMessage("‚úÖ ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶∞‡¶ø‡¶∏‡ßá‡¶ü ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤‡ßá ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá", "success");
                        hideForgotPassword();
                    })
                    .catch((error) => {
                        showAuthMessage(error.message, "error");
                    });
            }
        }
        
        // =================== CONTENT MANAGEMENT ===================
        function loadClasses() {
            const classGrid = document.getElementById('classGrid');
            
            const classes = [
                { name: "Class 6", icon: "6Ô∏è‚É£", description: "‡¶∑‡¶∑‡ßç‡¶† ‡¶∂‡ßç‡¶∞‡ßá‡¶£‡ßÄ" },
                { name: "Class 7", icon: "7Ô∏è‚É£", description: "‡¶∏‡¶™‡ßç‡¶§‡¶Æ ‡¶∂‡ßç‡¶∞‡ßá‡¶£‡ßÄ" },
                { name: "Class 8", icon: "8Ô∏è‚É£", description: "‡¶Ö‡¶∑‡ßç‡¶ü‡¶Æ ‡¶∂‡ßç‡¶∞‡ßá‡¶£‡ßÄ" },
                { name: "Class 9", icon: "9Ô∏è‚É£", description: "‡¶®‡¶¨‡¶Æ ‡¶∂‡ßç‡¶∞‡ßá‡¶£‡ßÄ" },
                { name: "Class 10", icon: "üîü", description: "‡¶¶‡¶∂‡¶Æ ‡¶∂‡ßç‡¶∞‡ßá‡¶£‡ßÄ" }
            ];
            
            classGrid.innerHTML = classes.map(cls => `
                <div class="class-card" onclick="selectClass('${cls.name}', '${cls.description}')">
                    <div class="class-icon">${cls.icon}</div>
                    <h3>${cls.name}</h3>
                    <p>${cls.description}</p>
                </div>
            `).join('');
        }
        
        function selectClass(className, description) {
            currentClass = className;
            document.getElementById('classSection').style.display = 'none';
            document.getElementById('subjectSection').style.display = 'block';
            document.getElementById('classNameDisplay').textContent = `${className} - ${description}`;
            
            loadSubjects();
        }
        
        function loadSubjects() {
            const subjectGrid = document.getElementById('subjectGrid');
            
            const subjects = [
                { name: "‡¶ó‡¶£‡¶ø‡¶§", icon: "‚ûï", code: "math" },
                { name: "‡¶á‡¶Ç‡¶∞‡ßá‡¶ú‡¶ø", icon: "üî§", code: "english" },
                { name: "‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶®", icon: "üî¨", code: "science" },
                { name: "‡¶§‡¶•‡ßç‡¶Ø ‡¶ì ‡¶Ø‡ßã‡¶ó‡¶æ‡¶Ø‡ßã‡¶ó ‡¶™‡ßç‡¶∞‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§‡¶ø", icon: "üíª", code: "ict" },
                { name: "‡¶ï‡ßÉ‡¶∑‡¶ø ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ", icon: "üå±", code: "agriculture" }
            ];
            
            subjectGrid.innerHTML = subjects.map(subject => `
                <div class="subject-card" onclick="selectSubject('${subject.name}', '${subject.code}')">
                    <div class="subject-icon">${subject.icon}</div>
                    <h3>${subject.name}</h3>
                    <p>‡¶¨‡¶á, ‡¶ó‡¶æ‡¶á‡¶°, ‡¶®‡ßã‡¶ü ‡¶è‡¶¨‡¶Ç MCQ</p>
                </div>
            `).join('');
        }
        
        function selectSubject(subjectName, subjectCode) {
            currentSubject = { name: subjectName, code: subjectCode };
            document.getElementById('subjectSection').style.display = 'none';
            document.getElementById('materialsSection').style.display = 'block';
            document.getElementById('subjectNameDisplay').textContent = `${currentClass} - ${subjectName}`;
            
            loadMaterials();
        }
        
        function loadMaterials() {
            const materialsList = document.getElementById('materialsList');
            materialsList.innerHTML = `
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <p>‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>
                </div>
            `;
            
            if (!db) {
                materialsList.innerHTML = `
                    <div class="empty-state">
                        <h3>‚ùå ‡¶°‡ßá‡¶ü‡¶æ‡¶¨‡ßá‡¶ú ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ó ‡¶®‡ßá‡¶á</h3>
                        <p>‡¶™‡ßÉ‡¶∑‡ßç‡¶†‡¶æ‡¶ü‡¶ø ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®</p>
                    </div>
                `;
                return;
            }
            
            db.ref('materials')
                .orderByChild('class')
                .equalTo(currentClass)
                .once('value')
                .then((snapshot) => {
                    let html = '';
                    let count = 0;
                    
                    if (snapshot.exists()) {
                        snapshot.forEach((child) => {
                            const data = child.val();
                            
                            // Check if material matches the subject
                            if (data.subject && data.subject.toLowerCase() === currentSubject.code.toLowerCase()) {
                                count++;
                                
                                const typeIcon = getTypeIcon(data.type);
                                const fileUrl = data.link || data.fileUrl || data.downloadUrl;
                                const linkType = data.linkType || 'other';
                                const dateStr = data.date || new Date(data.timestamp).toLocaleDateString('bn-BD');
                                
                                html += `
                                    <div class="material-item">
                                        <h4>
                                            ${typeIcon} ${data.title || '‡¶∂‡¶ø‡¶∞‡ßã‡¶®‡¶æ‡¶Æ ‡¶®‡ßá‡¶á'}
                                        </h4>
                                        <span class="material-type ${getTypeClass(data.type)}">${data.type || '‡¶ü‡¶æ‡¶á‡¶™ ‡¶®‡ßá‡¶á'}</span>
                                        ${fileUrl ? `<span style="display: inline-block; background: #e8f6e8; color: #27ae60; padding: 4px 10px; border-radius: 15px; font-size: 0.8rem; margin-left: 10px;">‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶Ü‡¶õ‡ßá</span>` : ''}
                                        <p style="margin-top: 10px; color: #444;">${data.description || '‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶¨‡¶∞‡ßç‡¶£‡¶®‡¶æ ‡¶®‡ßá‡¶á'}</p>
                                        <div class="material-meta">
                                            <span>üìÖ ${dateStr}</span>
                                            <span>üë§ ${data.addedBy || '‡¶è‡¶°‡¶Æ‡¶ø‡¶®'}</span>
                                        </div>
                                        ${fileUrl ? `
                                        <div class="file-actions">
                                            <button onclick="openFile('${fileUrl}')" class="open-btn">
                                                üîó ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶ì‡¶™‡ßá‡¶®
                                            </button>
                                            <button onclick="downloadFile('${fileUrl}', '${data.title || 'file'}')" class="download-btn">
                                                ‚¨áÔ∏è ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°
                                            </button>
                                        </div>
                                        ` : ''}
                                    </div>
                                `;
                            }
                        });
                    }
                    
                    if (count === 0) {
                        html = `
                            <div class="empty-state">
                                <h3>üòî ‡¶ï‡ßã‡¶®‡ßã ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø</h3>
                                <p>‡¶è‡¶á ‡¶¨‡¶ø‡¶∑‡ßü‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶ñ‡¶®‡ßã ‡¶ï‡ßã‡¶®‡ßã ‡¶ï‡¶®‡ßç‡¶ü‡ßá‡¶®‡ßç‡¶ü ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡¶®‡¶ø‡•§</p>
                            </div>
                        `;
                    }
                    
                    materialsList.innerHTML = html;
                })
                .catch((error) => {
                    materialsList.innerHTML = `
                        <div class="empty-state">
                            <h3>‚ùå ‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ</h3>
                            <p>${error.message}</p>
                        </div>
                    `;
                });
        }
        
        // =================== FILE MANAGEMENT ===================
        function loadFiles() {
            const filesList = document.getElementById('filesList');
            const filesLoading = document.getElementById('filesLoading');
            
            if (!db) {
                filesList.innerHTML = `
                    <div class="empty-state">
                        <h3>‚ùå ‡¶°‡ßá‡¶ü‡¶æ‡¶¨‡ßá‡¶ú ‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ó ‡¶®‡ßá‡¶á</h3>
                    </div>
                `;
                filesLoading.style.display = 'none';
                return;
            }
            
            db.ref('files').orderByChild('timestamp').once('value')
                .then((snapshot) => {
                    filesLoading.style.display = 'none';
                    
                    if (!snapshot.exists()) {
                        filesList.innerHTML = `
                            <div class="empty-state">
                                <h3>üìÅ ‡¶ï‡ßã‡¶®‡ßã ‡¶´‡¶æ‡¶á‡¶≤ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø</h3>
                                <p>‡¶è‡¶ñ‡¶®‡ßã ‡¶ï‡ßã‡¶®‡ßã ‡¶´‡¶æ‡¶á‡¶≤ ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡¶®‡¶ø‡•§</p>
                            </div>
                        `;
                        return;
                    }
                    
                    let html = '';
                    let index = 1;
                    
                    snapshot.forEach((child) => {
                        const data = child.val();
                        const key = child.key;
                        
                        const fileTypeBadge = getFileTypeBadge(data.type);
                        const fileSize = formatFileSize(data.size);
                        const fileIcon = getFileIcon(data.type);
                        
                        html += `
                            <div class="material-item">
                                <h4>
                                    ${fileIcon} ${data.fileName || data.originalName}
                                </h4>
                                ${fileTypeBadge}
                                <span class="material-type ${getTypeClass(data.type)}">${data.type || '‡¶´‡¶æ‡¶á‡¶≤'}</span>
                                <p style="margin-top: 10px; color: #444;">${data.description || '‡¶¨‡¶∞‡ßç‡¶£‡¶®‡¶æ ‡¶®‡ßá‡¶á'}</p>
                                <div class="material-meta">
                                    <span>üìÇ ${data.class || '‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ ‡¶®‡ßá‡¶á'}</span>
                                    <span>üìö ${getSubjectName(data.subject)}</span>
                                    <span>üìä ${fileSize}</span>
                                    <span>üìÖ ${data.uploadDate}</span>
                                </div>
                                <div class="file-actions">
                                    <button onclick="viewFile('${key}')" class="view-btn">
                                        üëÅÔ∏è ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®
                                    </button>
                                    <button onclick="downloadFile('${data.url}', '${data.fileName || data.originalName}')" class="download-btn">
                                        ‚¨áÔ∏è ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°
                                    </button>
                                </div>
                            </div>
                        `;
                        index++;
                    });
                    
                    filesList.innerHTML = html;
                })
                .catch((error) => {
                    filesLoading.style.display = 'none';
                    filesList.innerHTML = `
                        <div class="empty-state">
                            <h3>‚ùå ‡¶´‡¶æ‡¶á‡¶≤ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ</h3>
                            <p>${error.message}</p>
                        </div>
                    `;
                });
        }
        
        function viewFile(key) {
            // This would open a modal or new window to view the file
            // For now, we'll just show a message
            showStatus("‡¶´‡¶æ‡¶á‡¶≤ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã ‡¶π‡¶ö‡ßç‡¶õ‡ßá...", "info");
            
            // Get file data and open in new tab
            db.ref('files/' + key).once('value')
                .then((snapshot) => {
                    const data = snapshot.val();
                    if (data && data.url) {
                        window.open(data.url, '_blank');
                    } else {
                        showStatus("‡¶´‡¶æ‡¶á‡¶≤ ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø", "error");
                    }
                })
                .catch((error) => {
                    showStatus("‡¶´‡¶æ‡¶á‡¶≤ ‡¶≤‡ßã‡¶° ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•", "error");
                });
        }
        
        // =================== BOOKS & VIDEOS ===================
        function loadBooks() {
            const booksList = document.getElementById('booksList');
            
            if (!db) return;
            
            // Load books (type = '‡¶¨‡¶á' or '‡¶ó‡¶æ‡¶á‡¶°')
            db.ref('materials')
                .orderByChild('type')
                .once('value')
                .then((snapshot) => {
                    let html = '';
                    let count = 0;
                    
                    if (snapshot.exists()) {
                        snapshot.forEach((child) => {
                            const data = child.val();
                            
                            if (data.type === '‡¶¨‡¶á' || data.type === '‡¶ó‡¶æ‡¶á‡¶°') {
                                count++;
                                const fileUrl = data.link || data.fileUrl;
                                
                                html += `
                                    <div class="material-item" style="margin-bottom: 15px;">
                                        <h4>
                                            üìö ${data.title || '‡¶¨‡¶á'}
                                        </h4>
                                        <span class="material-type ${getTypeClass(data.type)}">${data.type}</span>
                                        <span style="display: inline-block; background: #f0f7ff; color: #3498db; padding: 4px 10px; border-radius: 15px; font-size: 0.8rem; margin-left: 10px;">
                                            ${data.class || '‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ ‡¶®‡ßá‡¶á'}
                                        </span>
                                        <p style="margin-top: 10px; color: #444;">${data.description || '‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶¨‡¶∞‡ßç‡¶£‡¶®‡¶æ ‡¶®‡ßá‡¶á'}</p>
                                        ${fileUrl ? `
                                        <div class="file-actions">
                                            <button onclick="openFile('${fileUrl}')" class="open-btn">
                                                üìñ ‡¶™‡¶°‡¶º‡ßÅ‡¶®
                                            </button>
                                            <button onclick="downloadFile('${fileUrl}', '${data.title || 'book'}')" class="download-btn">
                                                ‚¨áÔ∏è ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶°
                                            </button>
                                        </div>
                                        ` : ''}
                                    </div>
                                `;
                            }
                        });
                    }
                    
                    if (count === 0) {
                        html = `
                            <div class="empty-state">
                                <h3>üìö ‡¶ï‡ßã‡¶®‡ßã ‡¶¨‡¶á ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø</h3>
                                <p>‡¶è‡¶ñ‡¶®‡ßã ‡¶ï‡ßã‡¶®‡ßã ‡¶¨‡¶á ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡¶®‡¶ø‡•§</p>
                            </div>
                        `;
                    }
                    
                    booksList.innerHTML = html;
                });
        }
        
        function loadVideos() {
            const videosList = document.getElementById('videosList');
            
            if (!db) return;
            
            // Load videos (type = '‡¶≠‡¶ø‡¶°‡¶ø‡¶ì' or linkType = 'youtube')
            db.ref('materials')
                .orderByChild('type')
                .once('value')
                .then((snapshot) => {
                    let html = '';
                    let count = 0;
                    
                    if (snapshot.exists()) {
                        snapshot.forEach((child) => {
                            const data = child.val();
                            
                            if (data.type === '‡¶≠‡¶ø‡¶°‡¶ø‡¶ì' || data.linkType === 'youtube') {
                                count++;
                                const videoUrl = data.link || data.fileUrl;
                                
                                html += `
                                    <div class="material-item" style="margin-bottom: 15px;">
                                        <h4>
                                            üé¨ ${data.title || '‡¶≠‡¶ø‡¶°‡¶ø‡¶ì'}
                                        </h4>
                                        <span class="material-type video">‡¶≠‡¶ø‡¶°‡¶ø‡¶ì</span>
                                        <span style="display: inline-block; background: #f0f7ff; color: #3498db; padding: 4px 10px; border-radius: 15px; font-size: 0.8rem; margin-left: 10px;">
                                            ${data.class || '‡¶ï‡ßç‡¶≤‡¶æ‡¶∏ ‡¶®‡ßá‡¶á'}
                                        </span>
                                        <p style="margin-top: 10px; color: #444;">${data.description || '‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶¨‡¶∞‡ßç‡¶£‡¶®‡¶æ ‡¶®‡ßá‡¶á'}</p>
                                        ${videoUrl ? `
                                        <div class="file-actions">
                                            <button onclick="openFile('${videoUrl}')" class="open-btn">
                                                ‚ñ∂Ô∏è ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®
                                            </button>
                                        </div>
                                        ` : ''}
                                    </div>
                                `;
                            }
                        });
                    }
                    
                    if (count === 0) {
                        html = `
                            <div class="empty-state">
                                <h3>üé¨ ‡¶ï‡ßã‡¶®‡ßã ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø</h3>
                                <p>‡¶è‡¶ñ‡¶®‡ßã ‡¶ï‡ßã‡¶®‡ßã ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡¶®‡¶ø‡•§</p>
                            </div>
                        `;
                    }
                    
                    videosList.innerHTML = html;
                });
        }
        
        // =================== HELPER FUNCTIONS ===================
        function getTypeIcon(type) {
            switch(type) {
                case '‡¶¨‡¶á': return 'üìö';
                case '‡¶ó‡¶æ‡¶á‡¶°': return 'üìñ';
                case '‡¶®‡ßã‡¶ü': return 'üìù';
                case '‡¶≠‡¶ø‡¶°‡¶ø‡¶ì': return 'üé¨';
                case '‡¶™‡¶ø‡¶°‡¶ø‡¶è‡¶´': return 'üìÑ';
                case '‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®': return '‚ùì';
                case '‡¶õ‡¶¨‡¶ø': return 'üñºÔ∏è';
                case 'MCQ': return 'üî†';
                default: return 'üìÅ';
            }
        }
        
        function getTypeClass(type) {
            const types = {
                '‡¶¨‡¶á': 'book',
                '‡¶ó‡¶æ‡¶á‡¶°': 'guide',
                '‡¶®‡ßã‡¶ü': 'note',
                '‡¶≠‡¶ø‡¶°‡¶ø‡¶ì': 'video',
                '‡¶™‡¶ø‡¶°‡¶ø‡¶è‡¶´': 'pdf',
                '‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®': 'question',
                '‡¶õ‡¶¨‡¶ø': 'image',
                'MCQ': 'question'
            };
            return types[type] || 'book';
        }
        
        function getFileIcon(type) {
            switch(type) {
                case 'pdf': return 'üìÑ';
                case 'image': return 'üñºÔ∏è';
                case 'video': return 'üé¨';
                case 'doc': return 'üìù';
                case 'excel': return 'üìä';
                case 'ppt': return 'üìΩÔ∏è';
                case 'zip': return 'üì¶';
                default: return 'üìÅ';
            }
        }
        
        function getFileTypeBadge(type) {
            const badges = {
                'pdf': '<span class="file-type-badge file-type-pdf">PDF</span>',
                'image': '<span class="file-type-badge file-type-image">IMG</span>',
                'video': '<span class="file-type-badge file-type-video">VID</span>',
                'doc': '<span class="file-type-badge file-type-doc">DOC</span>',
                'excel': '<span class="file-type-badge file-type-doc">XLS</span>',
                'ppt': '<span class="file-type-badge file-type-doc">PPT</span>',
                'zip': '<span class="file-type-badge file-type-zip">ZIP</span>',
                'other': '<span class="file-type-badge file-type-other">FILE</span>'
            };
            return badges[type] || badges['other'];
        }
        
        function getSubjectName(subjectCode) {
            const subjects = {
                'math': '‡¶ó‡¶£‡¶ø‡¶§',
                'english': '‡¶á‡¶Ç‡¶∞‡ßá‡¶ú‡¶ø',
                'science': '‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶®',
                'ict': 'ICT',
                'agriculture': '‡¶ï‡ßÉ‡¶∑‡¶ø'
            };
            return subjects[subjectCode] || subjectCode || '‡¶¨‡¶ø‡¶∑‡¶Ø‡¶º ‡¶®‡ßá‡¶á';
        }
        
        function formatFileSize(bytes) {
            if (!bytes) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        function openFile(url) {
            if (url) {
                window.open(url, '_blank');
            } else {
                showStatus("‡¶´‡¶æ‡¶á‡¶≤ ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø", "error");
            }
        }
        
        function downloadFile(url, fileName) {
            if (url) {
                const link = document.createElement('a');
                link.href = url;
                link.download = fileName || 'download';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                showStatus("‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá", "success");
            } else {
                showStatus("‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø", "error");
            }
        }
        
        // =================== NAVIGATION ===================
        function goBackToClasses() {
            document.getElementById('classSection').style.display = 'block';
            document.getElementById('subjectSection').style.display = 'none';
            currentClass = null;
        }
        
        function goBackToSubjects() {
            document.getElementById('subjectSection').style.display = 'block';
            document.getElementById('materialsSection').style.display = 'none';
            currentSubject = null;
        }
        
        function switchTab(tabName) {
            // Hide all tabs
            const tabs = document.querySelectorAll('.tab-content');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Remove active class from all tab buttons
            const tabButtons = document.querySelectorAll('.tab');
            tabButtons.forEach(button => button.classList.remove('active'));
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked button
            event.target.classList.add('active');
            
            // Load data if needed
            if (tabName === 'fileTab') {
                loadFiles();
            } else if (tabName === 'bookTab') {
                loadBooks();
            } else if (tabName === 'videoTab') {
                loadVideos();
            }
        }
        
        function showAuthForm(formType) {
            // Get tab elements
            const loginTab = document.getElementById('loginTab');
            const registerTab = document.getElementById('registerTab');
            const loginForm = document.getElementById('loginForm');
            const registerForm = document.getElementById('registerForm');
            
            // Reset all tabs and forms
            loginTab.classList.remove('active');
            registerTab.classList.remove('active');
            loginForm.classList.remove('active');
            registerForm.classList.remove('active');
            
            // Show selected form and tab
            if (formType === 'login') {
                loginTab.classList.add('active');
                loginForm.classList.add('active');
            } else {
                registerTab.classList.add('active');
                registerForm.classList.add('active');
            }
            
            // Clear auth message
            document.getElementById('authMessage').style.display = 'none';
        }
        
        // =================== MESSAGE FUNCTIONS ===================
        function showStatus(message, type) {
            const statusDiv = document.getElementById('statusMessage');
            statusDiv.textContent = message;
            statusDiv.className = `status-message status-${type}`;
            statusDiv.style.display = 'block';
            
            setTimeout(() => {
                statusDiv.style.display = 'none';
            }, 3000);
        }
        
        function showAuthMessage(message, type) {
            const msgDiv = document.getElementById('authMessage');
            msgDiv.textContent = message;
            msgDiv.style.display = 'block';
            
            if (type === 'error') {
                msgDiv.style.background = '#ffe6e6';
                msgDiv.style.color = '#d32f2f';
                msgDiv.style.border = '1px solid #ffcdd2';
            } else if (type === 'success') {
                msgDiv.style.background = '#e6ffe6';
                msgDiv.style.color = '#2e7d32';
                msgDiv.style.border = '1px solid #c8e6c9';
            }
            
            setTimeout(() => {
                msgDiv.style.display = 'none';
            }, 5000);
        }
        
        // =================== PWA FUNCTIONS ===================
        function setupServiceWorker() {
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('sw.js?v=' + APP_VERSION)
                    .then(registration => {
                        console.log('‚úÖ Service Worker registered:', registration.scope);
                        
                        // Check for updates periodically
                        setInterval(() => {
                            registration.update();
                        }, 60 * 60 * 1000); // Every hour
                    })
                    .catch(error => {
                        console.log('‚ùå Service Worker registration failed:', error);
                    });
            }
            
            // Check if app is installed
            checkAppInstalled();
            
            // Listen for install prompt
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                
                // Show install button
                const installBtn = document.getElementById('installButton');
                if (installBtn) {
                    installBtn.style.display = 'inline-flex';
                    installBtn.onclick = () => installApp();
                }
            });
            
            // When app is installed
            window.addEventListener('appinstalled', () => {
                isAppInstalled = true;
                document.getElementById('pwaStatus').style.display = 'block';
                showStatus("‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶á‡¶®‡¶∏‡ßç‡¶ü‡¶≤ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá! üéâ", "success");
            });
        }
        
        function checkAppInstalled() {
            const isStandalone = window.matchMedia('(display-mode: standalone)').matches;
            isAppInstalled = isStandalone || window.navigator.standalone;
            
            if (isAppInstalled) {
                document.getElementById('pwaStatus').style.display = 'block';
            }
        }
        
        function installApp() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('‚úÖ User accepted install prompt');
                    }
                    deferredPrompt = null;
                });
            }
        }
        
        // =================== INITIALIZATION ===================
        document.addEventListener('DOMContentLoaded', function() {
            initializeFirebase();
            
            // Show login form by default
            showAuthForm('login');
            
            // Setup search functionality
            const searchContent = document.getElementById('searchContent');
            if (searchContent) {
                searchContent.addEventListener('input', function() {
                    // Implement search functionality here
                    console.log('Searching:', this.value);
                });
            }
            
            const searchFiles = document.getElementById('searchFiles');
            if (searchFiles) {
                searchFiles.addEventListener('input', function() {
                    // Implement files search functionality here
                    console.log('Searching files:', this.value);
                });
            }
            
            // Setup enter key for login
            document.getElementById('loginPassword').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    loginUser();
                }
            });
            
            document.getElementById('registerConfirmPassword').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    registerUser();
                }
            });
        });
    </script>
</body>
</html>